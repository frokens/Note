## 对偶理论
>[!对偶思想]
>原始问题比较难以求解，通过构建其对偶问题，期望解决这个对偶问题得到其原问题的下界或上界
>「原问题和对偶问题的**最优解**的关系」其实就是一个「 minx 、 maxλ 算符交换」的过程

如何构建呢？
##### 1. 从reduce cost 出发构造对偶问题
原问题：
$$
\begin{gather}\max{z} = c^TX\\s.t.\begin{cases}AX = b\\x \ge 0\end{cases}\end{gather}
$$
而其的检验数为：
$$
r_q = c_q  - c_B^TB^{-1}A_q
$$
如果此时是最优解，那么要满足两点：
- 基解大于等于0： $x_B = B^{-1}b \ge 0$
- 所有的redunce cost小于等于0： $c_q - c^T_BB^{-1}A_q \le 0$

此时令 $Y^T = c^T_BB^{-1}$
则可以转化为：
$$
A^T Y \ge c
$$

此时目标函数：
$$
b^TY = Y^Tb = c^T_BB^{-1}b = c^T_B x_B
$$

由此对偶问题为：
$$
\begin{gather}\min{ b^T Y}\\s.t. A^TY \ge c^T \\ \lambda  \in R^m\end{gather}
$$
##### 2. 从拉格朗日乘数法推出对偶问题：
对偶问题实际上是在寻找原问题（若是极大化问题）上界的最小值

松弛问题为：
$$
\begin{gather} \max_{X\in R^n}{c^TX - \lambda^T(AX-b)} = (c^T-\lambda^T A)X +\lambda^T b\\s.t. X\ge 0\end{gather}
$$


此时求其对偶问题（求上界的最小值）
$$
\begin{gather} \min_{\lambda \in R^m}{\max_{x \in R^n}{(c^T-\lambda^T A)X + \lambda b^T}}\\ s.t. X \ge 0\end{gather}
$$
现在对其进行分析：
先看内部的 $\max_{x \in R^n}$ 由于 $\lambda^T b$ 不包含 $x$ 则可以提出不考虑
而在内部，可以将 $\lambda$ 看作一个定值，若 $c^T - \lambda^T A \gt 0$ （这是一个 $1\times n$ 的矩阵）即其中任意一列的值大于0，则可以将那一列对应的 $x$ 设为 $\infty$ 那外部的 $\min_{\lambda \in R^m}$ 一定不可能取到最小值，所以要约束 $c^T - \lambda^T A \le 0$
 当  $c^T - \lambda^T A \le 0$ 时，内部对  $c^T - \lambda^T A$ 非0的列，$x^* = 0$ 取得目标函数最大值（此处可以证明一半的松弛定理）
 且此时的最优目标函数内的 $(c^T - \lambda^T A)X$  一定等于 0 （ 因为$c^T - \lambda^T A$为非正）
于是对偶问题就会变为：
$$
\begin{gather}\min_{\lambda \in R^m}{\lambda b^T = b^T \lambda}\\s.t. A^T\lambda \ge c^T \end{gather}
$$
如果原式存在松弛变量 $c$ 中的列为0可进一步推出：

$$
\begin{gather}\min_{\lambda \in R^m}{\lambda b^T = b^T \lambda}\\s.t. A^T\lambda \ge c^T \\ \lambda \ge 0\end{gather}
$$

从这里也可以看出松弛定理，即若对偶问题的约束条件为不等号，原问题的最优解 $x^* = 0$  



#### 对偶问题的基本性质
##### 1. 对称性定理： 对偶问题的对偶问题是原问题
证明：
![[Pasted image 20250411091320.png|400]]

##### 2. 弱对偶原理(弱对偶性)
$X^*$和$Y^*$ 分别是问题(P) 和 (D) 的可行解，则必有
$$
CX^*\le Y^*b
$$
推论1： 最大化问题的目标函数值 是 最小化问题的目标函数的下界， 反之亦然
推论2：在一对对偶问题 （P） 和（D) 若一个问题可行但无界，另一个问题一定无可行解
###### 证明
由于在构造对偶问题过程中的约束条件，是用最小化上界或最小化下届目标函数得出的，，可以直接用对偶问题和原问题的约束条件作为证明的桥梁
$$
	\begin{gather}\sum_{i=1}^{n}c_ix_i^* \le \sum_{i=1}^n(\sum_{j=1}^m a_{ij}y_j^*)x_i^* = \sum_{i=1}^n\sum_{j=1}^m (a_{ij}x_i^*)y_j^* \le \sum^m_{j=1}b_jy_j^*\end{gather}
$$

##### 3.  最优性定理：
$\hat{X}$和$\hat{Y}$ 分别是问题(P) 和 (D) 的可行解，并且
$$
C\hat{X} = B\hat{Y} ~,\text{即：} \max{Z} = min{W}
$$
则$\hat{X}$和$\hat{Y}$ 分别为各自问题的最优可行解
###### 证明
通过弱对偶质和最大最小值证明
![[Pasted image 20250428154134.png|]]

##### 4. 强对偶性：
若原问题及其对偶问题均有可行解，则两者均有最优解，且它们最优解的目标函数值相同

##### 5. 互补松弛性（用于降维后计算另一最优解）：
在线胜规划问题的最优解中，如果对应某一约束条件的对偶变量值为非零，则该约束条件取严格等式；反之如果约束条件取严格不等式，则其对应的对偶变 量一定为零。
![[Pasted image 20250428154315.png|300]]
证明：
![[Pasted image 20250428154427.png|500]]

这里体现了最大最小转化时，需要保证存在上下界的条件，由此转化而来。

转化方式：
![[Pasted image 20250428160456.png|500]]
## 灵敏度分析

只需考虑对最终最优解(max)的影响情况：
$$
\begin{gather}\text{最优性条件： }\sigma = C - C_BB_{-1}N \le 0 \\
~\text{或对列 }~~\sigma_j =  c_j - c_jB_{-1}p_j\\\\
\text{可行性条件：}X_B = B^{-1}b \ge 0~~~~~~~~~~~~\end{gather}
$$

Q1：当系数A，b，C发生改变时，目前最优基 是否还是最优？
Q2：为保持目前最优基还是最优，系数A，b， C的允许变化范围是什么？

假设每次只有一种系数变化： 
1. 目标系数C变化
	1. 基变量系数发生变化
	2. 非基变量系数发生变化
2. 右端常数b变化
3. 增加一个变量
4. 增加一个约束
5. 技术系数A发生变化。
	1. 非基系数发生变化
	2. 基系数发生变化

