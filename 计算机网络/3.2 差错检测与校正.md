为什么需要差错检测：
有如下原因造成信号幅度、频率和相位的衰减或畸变（又称为失真）：
	线路本身电气特性造成的随机噪声(热噪声)影响
	电信号在线路上产生反射造成的回音效应
	相邻线路间的串扰以及各种外界因素（如大气中闪电、开关的跳火、外界强电流磁场的变化和电源的波动等）

差错：
   数据通信中，前面的原因就会造成接收端收到的二进制数位（或称为码元）和发送端实际发送的二进制数位不一致
### 3.2.1 传输差错的特性
#### 1. 噪声分类：
1. 信道所固有的，持续存在的随机热噪声。
	- 可引起随机性差错
2. 由于外界特定的短暂原因所造成的冲击噪声。
	- 可引起突发性差错

#### 2.噪声比较：
- 随机错通常较少
- 冲击噪声的幅度可以相当大 ，它是传输中产生差错的主要原因

#### 3. Pe误码率（衡量信道质量）
通常用10的负若干次方来标志信道的误码率Pe
![[Pasted image 20250403201721.png|300]]

#### 4. 差错控制编码的原理：
信息位：要发送的数据
冗余位：在向信道发送之前，先按照某种关系加上一定的冗余位

发送与接收的过程：
	发送时：信息位+冗余位构成码字发送；
	接收时：收到码字后查看信息位和冗余位，并检查它们之间的关系（校验过程），以发现传输过程中是否有差错发生

#### 5. 差错控制编码分类：
- 检错码:能自动发现差错的编码
- 纠错码:不仅能发现差错而且能自动纠正差错的编码

#### 6. 衡量编码性能的参数
编码效率R :就是码字中信息位所占的比例。
若码字中信息位为k位，编码时外加冗余位为r位，则编码后得到的码字长为n = k + r位。
$$R = \frac{k}{n} = \frac{k}{k+r}$$
编码效率越高，即R越大，则信道中用来传送信息码元的有效利用率就越高。
（多发判断，效率低）


#### 7. 差错控制基本形式
##### (1). 自动请求重发ARQ （Automatic ReQuest for Repeat)
只需少量冗余码就能获得很低的误码率，检错效果较好。但必须有反馈信道，信道干扰大时，效率会降低。（检错码也可能出错， 反复要求发送）
![[Pasted image 20250403202242.png|300]]
需要反馈信道

##### (2). 前向纠错FEC (Forward Error Correction)
无需反馈信道，能用于单向通信
但FEC差错控制码与信道的差错统计特性有关，传输效率不高。（纠错码，冗余位长）
![[Pasted image 20250403202333.png|300]]
无需反馈信道

除非在单向传输或实时要求特别高（FEC由于不需要重发，实时性较好）等场合外，数据通信中使用更多的还是ARQ差错控制方式。


##### (3). 混合纠错HEC （ Hybrid Error Correction)
将上述两者混合使用
即当码字中的差错个数在纠正能力以内时，直接进行纠正；
当码字中的差错个数超出纠正能力时，则检出差错令其重发来纠正差错。
![[Pasted image 20250403202532.png|300]]

### 3.2.2 常用的检错码
#### 1. 奇偶校验码
奇偶校验码是通过增加冗余位来使得码字中“1”的个数保持奇或偶数的编码方法。
如信息组中各码元为I1,I2,I3,I4, …,In，
则发送的信息组码元是I1,I2,I3,I4, …,In, r
![[Pasted image 20250403202956.png|300]]

缺点：
	只能检测出每个信息组中奇数个码元错，检测不出偶数个码元错。
编码效率R为：$\frac{n}{n+1}$

(3). 垂直奇偶校验
![[Pasted image 20250403203148.png|300]]
能边发送边产生冗余位，同时也能边接收边校验。
能发现每列中的奇数位错，对突发错误的漏检率接近50%。

(4). 水平奇偶校验
![[Pasted image 20250403203312.png|300]]
能发现所有长度小于等于P的突发性错及水平方向的奇数个错；
但发送和接收必须要等待整块信息到齐后才能进行。
突发性出错往往是连续的，而只在同一行出错时，检测列仍然能检测出

(5). 水平垂直奇偶校验
![[Pasted image 20250403203634.png|300]]
能发现==所有==3位及3位以下的错误、奇数位错和大部分偶数位错，能发现所有突发长度小于等于p+1的突发性错，并具有一位的纠错能力。
![[Pasted image 20250403203729.png|250]]


#### 2.Internet校验和
是一个高层协议中用软件完成的高效的检错码。
Internet checksum长度为16位。

1）首先把检验和字段置为0；
2）对需校验的数据每个16位进行二进制反码求和(即高位溢出要加到低位)；
3）如果数据长度为奇数则补一字节0；
4）结果存在检验和字段中。

接收方把收到的需要检验数据的数据和校验和字段放在一起，再次用相同方法进行计算，最后结为0的话，表示正确；不为0的话，表示收到数据出错，丢弃该分组。
该校验方法只用反码加法和移位操作，具体实现时采用补码加法、移位和取反操作，是一种简单而高效的检错码。

例：RFC1071源码
```c
unsigned short csum(unsigned char *buffer, int count)
{
	register long sum = 0
	while(count > 1){
		// This is the inner loop
		sum += *(unsigned short *) buffer++;
		count -= 2;
	}
	// Add left-over byte, if any
	if (count > 0)
		sum += *(unsigned char *) buffer;
	//Fold 32-bits sum to 16-bits	
	while (sum >> 16)
		sum = (sum & 0xffff) + (sum >> 16);
	return ~sum;
}
```
#### 3. 循环冗余码
  假设信息流长度为k位，冗余流长度为r位 ，则发送的信息是k位信息位后面再加上r位冗余位，即$$T(x)=X^r*K(x)+R(x)$$$$\begin{array}由于R(x)是Xr*K(x)除以G(x)的余数，\\

  即：X^r*K(x)=G(x)*Q(x)+R(x)\\

  接收方得：T(x)= G(x)*Q(x)+R(x)+R(x)\\

  所以，T(x)= G(x)*Q(x)\end{array}$$
k的最低位比r的最高位高一位
接收方和发送方算法都是一致的，当接收方验算后为0，表示无错

![[Pasted image 20250404121606.png|600]]

若适当选取G(x)，使其含有（x+1）因子、常数项不为0、且周期大于等于n，那末，由此G(x)作为生成多项式产生的CRC码可检测所有的双错、奇数个错和突发长度小于等于r的突发性错及（$1-2^{-(r-1)}$）的突发长度为r+1的突发错和（$1-2^{-r}$）的突发长度大于r+1的突发性错。

![[Pasted image 20250404121642.png|500]]

下一位L由上一次的R3位寄存器的值和初始化输入取异或得出
最后将各个位寄存器的内容排空
在检验时，前半过程保持一致，在输入结束后，通过检测$R_0 \sim R_n$位寄存器内数值是否位为0 判读差错
![[Pasted image 20250404121704.png|600]]

### 3.2.3 常用的纠错码

#### 1. 海明码
纠错一位出错
##### 算法：
a)将码字每一位字从右至左进行编号，最右边为第一位。
b)凡编号为2的乘幂的位（1、2、4、8等）都是冗余校验位，其余是数据位。
c)将每个数据位的编号展开成2的乘幂之和，该数据位只由展开式中的校验位校验。
d)每个校验位连同其所负责的所有数据位一起构成偶校验。

###### 确定纠正单比特错误所需的冗余位数
设纠正单比特错误需增加的冗余位数为r，r应满足：
      $2^r ≥ m + r + 1$； m为数据单元的长度

![[Pasted image 20250410185125.png|500]]


##### 特点：
信息位越长，编码效率就越高，但不能适用于数据传输中突发性差错的控制。
编码效率为：R=n/(n+r)
为了能让海明码用于检测数据传输中突发性差错，可以采用和水平奇偶校验码相类似的水平海明码。

#### 2. 卷积码


#### 3. RS码
是一种前向纠错的信道编码，当接收器正确的收到足够的点后，它就可以恢复原来的多项式。
  RS码是在[[伽罗瓦域(Galois field)]]中运算。
  伽罗瓦域$GF(2^m)$就是有$2^m个元素：
  除0、1之外的元素都由 本原多项式P(x) 生成，并且加、减、乘、除法等四则运算在域内封闭。
  
本源多项式：
一个n次不可约多项式P(x)，满足能被 P(x) 整除的$x^k +1$的最小正整数k为$2^m-1$

所有m位二进制数可以被 GF($2^m$) 表示，且有一一对应关系

在GF(2m)域中，纠错码RS(n,k)含义：
  m——符号大小，如m=8表示符号由8位二进制数组成

  n——码块长度

  k——码块中信息码长度

  K=n-k=2t，是校验码的符号数，t是能纠正的错误符号数

例：RS(255,223)表示码块长度是255个符号，信息码是223个符号，校验码有32个符号，可纠正16个分散或连续的符号错误。


