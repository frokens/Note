## 概念介绍
快速幂（也称为二分幂）是一种高效计算 $a^b$  mod M  的方法，其基本思想是利用指数的二进制表示，将乘法操作次数从 O(b) 降到 O($log⁡b$)。
在这里运算域其实为 [[伽罗瓦域(Galois field)|有限域及伽罗华域]]
## 算法思想
要求$a^b$， 先将b写为二进制表达式：
$$b = b_k2^k + b_{k-1}2^{k-1} + \dots +b_12^1+b_02^0 $$
所以利用这个表示，我们可以写出：
$$a^b = a^{b_k2^k} \times a^{b_{k-1}2^{k-1}} \times \dots \times a^{b_12^1}+a^{b_02^0} $$
也就是说，每当$b_k$为1时，我们就把对应的 $a^{2^i}$ 乘到结果中去。

同时，我们可以通过递归或者迭代的方法不断平方得到 ：

- 初始时 $a^{2^0} = a$ ， $res=1$
- 之后如果 $b_k=1$ ，则 $res = res \times a$ , $a = a \times a$ 得到下一位a的权重
- 如果 $b_K = 0$ , 则 直接 $a = a \times a$ 
- 最后 b左移一位
### 代码
```cpp
ll modExp(ll a, ll b) {
    ll res = 1;            // 初始化结果为1，因为任何数的0次幂为1
    while(b) {             // 当 b 大于0时，循环处理 b 的每个二进制位
        if(b & 1)          // 检查当前最低位是否为1（即 b 的二进制表示中最右侧的位）
            res = (res * a) % M;  // 如果当前位为1，就将当前的 a 乘入结果 res，并对 M 取模
        a = (a * a) % M;   // 将 a 平方，得到 a^(2^i) 的下一项
        b >>= 1;           // 将 b 右移一位，相当于去掉最低位
    }
    return res;
}```
#幂 #模 #快速幂 #算法 

应用：
[[模逆元]]